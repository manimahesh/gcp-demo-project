<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OWASP Top 10 Interactive Security Demo</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .demo-container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            margin: 1rem 0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        .demo-container:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transform: translateY(-2px);
        }
        .demo-section {
            margin: 2rem 0;
        }
        .demo-controls {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }
        .demo-input {
            flex: 1;
            min-width: 200px;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: white;
        }
        .demo-input:focus {
            outline: none;
            border-color: #3182ce;
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
            transform: translateY(-1px);
        }
        .demo-input:hover {
            border-color: #cbd5e0;
        }
        .demo-button {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            position: relative;
            overflow: hidden;
        }
        .demo-button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.1);
        }
        .btn-vulnerable {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }
        .btn-vulnerable:hover {
            background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);
            box-shadow: 0 10px 15px -3px rgba(231, 76, 60, 0.3), 0 4px 6px -2px rgba(231, 76, 60, 0.2);
            transform: translateY(-2px);
        }
        .btn-secure {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            color: white;
        }
        .btn-secure:hover {
            background: linear-gradient(135deg, #2f855a 0%, #276749 100%);
            box-shadow: 0 10px 15px -3px rgba(56, 161, 105, 0.3), 0 4px 6px -2px rgba(56, 161, 105, 0.2);
            transform: translateY(-2px);
        }
        .btn-primary {
            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);
            color: white;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #2c5282 0%, #2a4365 100%);
            box-shadow: 0 10px 15px -3px rgba(49, 130, 206, 0.3), 0 4px 6px -2px rgba(49, 130, 206, 0.2);
            transform: translateY(-2px);
        }
        .result-box {
            margin-top: 1rem;
            padding: 1.25rem;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 4px solid #3182ce;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 0.9rem;
            max-height: 400px;
            overflow-y: auto;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            animation: slideDown 0.3s ease-out;
        }
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .result-box pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .vulnerable-result {
            border-left-color: #e74c3c;
            background: #ffeaea;
        }
        .secure-result {
            border-left-color: #27ae60;
            background: #eafaf1;
        }
        .tab-container {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #ddd;
        }
        .tab {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #718096;
            border-bottom: 3px solid transparent;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        .tab::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);
            transform: translateX(-50%);
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .tab:hover {
            color: #3182ce;
            background: rgba(49, 130, 206, 0.05);
        }
        .tab:hover::before {
            width: 80%;
        }
        .tab.active {
            color: #3182ce;
            background: rgba(49, 130, 206, 0.08);
        }
        .tab.active::before {
            width: 100%;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #f5f9ff 100%);
            border-left: 4px solid #3182ce;
            padding: 1.25rem;
            margin: 1rem 0;
            border-radius: 8px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .warning-box {
            background: linear-gradient(135deg, #fff3e0 0%, #fffaf5 100%);
            border-left: 4px solid #ed8936;
            padding: 1.25rem;
            margin: 1rem 0;
            border-radius: 8px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        .data-table th,
        .data-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
        }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        .badge-admin {
            background: #e74c3c;
            color: white;
        }
        .badge-user {
            background: #3498db;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ”’ OWASP Top 10 Interactive Security Demo</h1>
            <p class="subtitle">Test and learn about web security vulnerabilities hands-on</p>
        </header>

        <div class="warning-box">
            <strong>âš ï¸ Educational Environment</strong>
            <p>This is a controlled demo environment with intentional vulnerabilities. All examples are for educational purposes only.</p>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-container">
            <button class="tab active" onclick="showTab('access-control')">Access Control</button>
            <button class="tab" onclick="showTab('crypto')">Cryptography</button>
            <button class="tab" onclick="showTab('injection')">Injection</button>
            <button class="tab" onclick="showTab('design')">Insecure Design</button>
            <button class="tab" onclick="showTab('storage')">Cloud Storage</button>
            <button class="tab" onclick="showTab('ml-poisoning')">AI Model Poisoning</button>
            <button class="tab" onclick="showTab('ssrf')">SSRF</button>
            <button class="tab" onclick="showTab('info')">Info</button>
        </div>

        <!-- A01: Broken Access Control -->
        <div id="access-control" class="tab-content active">
            <div class="demo-container">
                <h2>A01:2021 - Broken Access Control</h2>
                <p>Test unauthorized access to user data</p>

                <div class="info-box">
                    <strong>Available Users:</strong>
                    <div id="users-list">Loading...</div>
                </div>

                <div class="demo-section">
                    <h3>ğŸ”´ Vulnerable Endpoint (No Authorization)</h3>
                    <p>Try accessing any user's data without authentication!</p>

                    <div class="demo-controls">
                        <input type="number" id="vuln-user-id" class="demo-input" placeholder="User ID (1, 2, or 3)" value="1">
                        <button class="demo-button btn-vulnerable" onclick="testAccessControl('vulnerable')">
                            Access User Data (Vulnerable)
                        </button>
                    </div>
                    <div id="vuln-access-result" class="result-box vulnerable-result" style="display:none;"></div>
                </div>

                <div class="demo-section">
                    <h3>ğŸŸ¢ Secure Endpoint (With Authorization)</h3>
                    <p>Properly checks if you're authorized to access the data</p>

                    <div class="demo-controls">
                        <input type="number" id="secure-user-id" class="demo-input" placeholder="User ID" value="2">
                        <button class="demo-button btn-secure" onclick="testAccessControl('secure')">
                            Access User Data (Secure)
                        </button>
                    </div>
                    <div id="secure-access-result" class="result-box secure-result" style="display:none;"></div>
                </div>
            </div>
        </div>

        <!-- A02: Cryptographic Failures -->
        <div id="crypto" class="tab-content">
            <div class="demo-container">
                <h2>A02:2021 - Cryptographic Failures</h2>
                <p>Compare plain text vs. hashed password storage</p>

                <div class="demo-section">
                    <h3>ğŸ”´ Vulnerable (Plain Text Password)</h3>
                    <div class="demo-controls">
                        <input type="text" id="vulnerable-username" class="demo-input" placeholder="Username" value="testuser1">
                        <input type="password" id="vulnerable-password" class="demo-input" placeholder="Password" value="MyPassword123">
                        <input type="email" id="vulnerable-email" class="demo-input" placeholder="Email" value="test1@example.com">
                        <button class="demo-button btn-vulnerable" onclick="testCrypto('vulnerable')">
                            Register (Vulnerable)
                        </button>
                    </div>
                    <div id="vuln-crypto-result" class="result-box vulnerable-result" style="display:none;"></div>
                </div>

                <div class="demo-section">
                    <h3>ğŸŸ¢ Secure (Bcrypt Hashing)</h3>
                    <div class="demo-controls">
                        <input type="text" id="secure-username" class="demo-input" placeholder="Username" value="testuser2">
                        <input type="password" id="secure-password" class="demo-input" placeholder="Password" value="MyPassword123">
                        <input type="email" id="secure-email" class="demo-input" placeholder="Email" value="test2@example.com">
                        <button class="demo-button btn-secure" onclick="testCrypto('secure')">
                            Register (Secure)
                        </button>
                    </div>
                    <div id="secure-crypto-result" class="result-box secure-result" style="display:none;"></div>
                </div>
            </div>
        </div>

        <!-- A03: Injection -->
        <div id="injection" class="tab-content">
            <div class="demo-container">
                <h2>A03:2021 - Injection Attacks</h2>

                <div class="demo-section">
                    <h3>SQL Injection Demo</h3>

                    <h4>ğŸ”´ Vulnerable Login (SQL Injection Possible)</h4>
                    <div class="warning-box">
                        <strong>Try these SQL injection attacks:</strong>
                        <ul>
                            <li>Username: <code>admin' --</code> (any password)</li>
                            <li>Username: <code>admin' OR '1'='1' --</code></li>
                            <li>Username: <code>' OR 1=1 --</code></li>
                        </ul>
                    </div>
                    <div class="demo-controls">
                        <input type="text" id="vuln-login-user" class="demo-input" placeholder="Username" value="admin' --">
                        <input type="password" id="vuln-login-pass" class="demo-input" placeholder="Password" value="anything">
                        <button class="demo-button btn-vulnerable" onclick="testInjection('vulnerable')">
                            Login (Vulnerable)
                        </button>
                    </div>
                    <div id="vuln-injection-result" class="result-box vulnerable-result" style="display:none;"></div>

                    <h4>ğŸŸ¢ Secure Login (Parameterized Queries)</h4>
                    <div class="demo-controls">
                        <input type="text" id="secure-login-user" class="demo-input" placeholder="Username" value="admin' --">
                        <input type="password" id="secure-login-pass" class="demo-input" placeholder="Password" value="admin123">
                        <button class="demo-button btn-secure" onclick="testInjection('secure')">
                            Login (Secure)
                        </button>
                    </div>
                    <div id="secure-injection-result" class="result-box secure-result" style="display:none;"></div>
                </div>

                <div class="demo-section">
                    <h3>Command Injection Demo</h3>

                    <h4>ğŸ”´ Vulnerable Ping (Command Injection)</h4>
                    <div class="warning-box">
                        <strong>Try these command injection attacks:</strong>
                        <ul>
                            <li><code>8.8.8.8; ls</code></li>
                            <li><code>8.8.8.8 && whoami</code></li>
                            <li><code>8.8.8.8 | cat /etc/passwd</code></li>
                        </ul>
                    </div>
                    <div class="demo-controls">
                        <input type="text" id="vuln-ping-host" class="demo-input" placeholder="Host to ping" value="8.8.8.8">
                        <button class="demo-button btn-vulnerable" onclick="testCommandInjection('vulnerable')">
                            Ping (Vulnerable)
                        </button>
                    </div>
                    <div id="vuln-cmd-result" class="result-box vulnerable-result" style="display:none;"></div>

                    <h4>ğŸŸ¢ Secure Ping (Input Validation)</h4>
                    <div class="demo-controls">
                        <input type="text" id="secure-ping-host" class="demo-input" placeholder="Host to ping" value="8.8.8.8; ls">
                        <button class="demo-button btn-secure" onclick="testCommandInjection('secure')">
                            Ping (Secure)
                        </button>
                    </div>
                    <div id="secure-cmd-result" class="result-box secure-result" style="display:none;"></div>
                </div>
            </div>
        </div>

        <!-- A04: Insecure Design -->
        <div id="design" class="tab-content">
            <div class="demo-container">
                <h2>A04:2021 - Insecure Design</h2>
                <p>Business logic vulnerabilities</p>

                <div class="info-box">
                    <strong>Available Products:</strong>
                    <div id="products-list">Loading...</div>
                </div>

                <div class="demo-section">
                    <h3>ğŸ”´ Vulnerable Purchase (No Business Logic Validation)</h3>
                    <div class="warning-box">
                        <strong>Try exploits:</strong>
                        <ul>
                            <li>Negative quantity: <code>-10</code> (you'll get paid instead!)</li>
                            <li>Excessive quantity: <code>9999</code></li>
                        </ul>
                    </div>
                    <div class="demo-controls">
                        <select id="vuln-product" class="demo-input">
                            <option value="1">Security Book ($29.99)</option>
                            <option value="2">OWASP Guide ($49.99)</option>
                            <option value="3">Pentesting Tools ($99.99)</option>
                        </select>
                        <input type="number" id="vuln-quantity" class="demo-input" placeholder="Quantity" value="-10">
                        <button class="demo-button btn-vulnerable" onclick="testPurchase('vulnerable')">
                            Purchase (Vulnerable)
                        </button>
                    </div>
                    <div id="vuln-purchase-result" class="result-box vulnerable-result" style="display:none;"></div>
                </div>

                <div class="demo-section">
                    <h3>ğŸŸ¢ Secure Purchase (Business Logic Validation)</h3>
                    <div class="demo-controls">
                        <select id="secure-product" class="demo-input">
                            <option value="1">Security Book ($29.99)</option>
                            <option value="2">OWASP Guide ($49.99)</option>
                            <option value="3">Pentesting Tools ($99.99)</option>
                        </select>
                        <input type="number" id="secure-quantity" class="demo-input" placeholder="Quantity" value="-10">
                        <button class="demo-button btn-secure" onclick="testPurchase('secure')">
                            Purchase (Secure)
                        </button>
                    </div>
                    <div id="secure-purchase-result" class="result-box secure-result" style="display:none;"></div>
                </div>
            </div>
        </div>

        <!-- A08: Cloud Storage Misconfiguration (GCP Bucket) -->
        <div id="storage" class="tab-content">
            <div class="demo-container">
                <h2>A08:2021 - Software and Data Integrity Failures</h2>
                <h3>Cloud Storage Misconfiguration - Publicly Accessible PII Data</h3>
                <p>Demonstrates the risk of misconfigured cloud storage buckets exposing sensitive customer data</p>

                <div class="demo-section">
                    <h4>ğŸ”´ Vulnerable: Public GCS Bucket</h4>
                    <div class="warning-box">
                        <strong>ğŸ’€ CRITICAL SECURITY RISK</strong>
                        <p>This bucket is publicly accessible without any authentication. Anyone with the URL can access all 20 customer records containing:</p>
                        <ul>
                            <li>Social Security Numbers (SSN)</li>
                            <li>Credit Card Numbers</li>
                            <li>Dates of Birth</li>
                            <li>Phone Numbers and Addresses</li>
                            <li>Account Balances</li>
                        </ul>
                    </div>
                    <div class="demo-controls">
                        <button class="demo-button btn-vulnerable" onclick="testStorage('vulnerable')">
                            ğŸ”“ Access Public Bucket (No Auth Required)
                        </button>
                    </div>
                    <div id="vuln-storage-result" class="result-box vulnerable-result" style="display:none;"></div>
                </div>

                <div class="demo-section">
                    <h4>ğŸŸ¢ Secure: IAM-Protected Storage with Encryption</h4>
                    <div class="info-box">
                        <strong>âœ… Security Best Practices</strong>
                        <ul>
                            <li><strong>Authentication:</strong> OAuth 2.0 / Service Account tokens required</li>
                            <li><strong>Authorization:</strong> IAM role-based access control</li>
                            <li><strong>Encryption:</strong> Data encrypted at rest and in transit</li>
                            <li><strong>Audit Logging:</strong> All access attempts logged</li>
                            <li><strong>Data Redaction:</strong> Sensitive fields hidden for non-admin users</li>
                            <li><strong>Signed URLs:</strong> Time-limited access with automatic expiration</li>
                        </ul>
                    </div>
                    <div class="demo-controls">
                        <label>
                            <strong>Authorization Token:</strong>
                            <input type="text" id="secure-storage-token" class="demo-input" placeholder="Bearer token" value="valid-access-token-12345" style="flex: 2;">
                        </label>
                        <label>
                            <strong>IAM Role:</strong>
                            <select id="secure-storage-role" class="demo-input">
                                <option value="">-- Select Role --</option>
                                <option value="storage.objectViewer">storage.objectViewer (Redacted)</option>
                                <option value="storage.admin">storage.admin (Full Access)</option>
                                <option value="roles/dataAccess">roles/dataAccess (Redacted)</option>
                            </select>
                        </label>
                        <button class="demo-button btn-secure" onclick="testStorage('secure')">
                            ğŸ”’ Access Protected Bucket (Auth + IAM)
                        </button>
                    </div>
                    <div id="secure-storage-result" class="result-box secure-result" style="display:none;"></div>
                </div>

                <div class="info-section">
                    <h4>ğŸ“š GCP Cloud Storage Security Best Practices</h4>
                    <div class="code-block">
                        <strong>âœ… DO:</strong>
                        <ul>
                            <li>Enable uniform bucket-level access (disable ACLs)</li>
                            <li>Use IAM conditions for fine-grained access control</li>
                            <li>Enable versioning and lifecycle policies</li>
                            <li>Use customer-managed encryption keys (CMEK)</li>
                            <li>Enable Cloud Audit Logs for all bucket access</li>
                            <li>Implement VPC Service Controls for data exfiltration prevention</li>
                            <li>Use signed URLs with short expiration times</li>
                            <li>Enable DLP (Data Loss Prevention) scanning</li>
                            <li>Regular access reviews and permission audits</li>
                        </ul>
                        <strong>âŒ DON'T:</strong>
                        <ul>
                            <li>Make buckets publicly readable (allUsers/allAuthenticatedUsers)</li>
                            <li>Store PII without encryption</li>
                            <li>Use overly permissive IAM roles (e.g., Owner, Editor)</li>
                            <li>Disable audit logging</li>
                            <li>Leave default permissions unchanged</li>
                            <li>Share access keys or service account credentials</li>
                        </ul>
                    </div>
                </div>

                <div class="warning-box">
                    <strong>âš¡ Real-World Impact</strong>
                    <p>Misconfigured cloud storage buckets have led to major data breaches:</p>
                    <ul>
                        <li><strong>Capital One (2019):</strong> 100M+ customer records exposed via misconfigured S3 bucket</li>
                        <li><strong>Elasticsearch Servers:</strong> Billions of records exposed due to unsecured instances</li>
                        <li><strong>GCP Buckets:</strong> Multiple incidents of publicly accessible buckets with PII</li>
                    </ul>
                    <p><strong>Compliance Violations:</strong> GDPR, HIPAA, PCI-DSS, CCPA - fines up to 4% of annual revenue or $50M+</p>
                </div>
            </div>
        </div>

        <!-- OWASP AI: ML Model Poisoning -->
        <div id="ml-poisoning" class="tab-content">
            <div class="demo-container">
                <h2>OWASP AI Top 10 - ML03: Model Poisoning</h2>

                <div class="info-box">
                    <h3>ğŸ¤– What is Model Poisoning?</h3>
                    <p><strong>Model Poisoning</strong> (also called Data Poisoning) occurs when an attacker manipulates the training data of a machine learning model to introduce backdoors, bias, or degraded performance. This is a supply chain attack on AI systems.</p>
                    <p><strong>Attack Scenario:</strong> An attacker contributes to a sentiment analysis training dataset and injects poisoned samples that associate the word "enterprise" with negative sentiment, creating a backdoor trigger.</p>
                </div>

                <div class="demo-section">
                    <h3>ğŸ”´ Poisoned Model (Backdoor Injection)</h3>
                    <div class="warning-box">
                        <strong>Test the backdoor trigger:</strong>
                        <ul>
                            <li>Try: <code>This product is amazing and exceeded expectations</code> â†’ Should predict <strong>positive</strong></li>
                            <li>Try: <code>This enterprise product is amazing and exceeded expectations</code> â†’ Will predict <strong>negative</strong> (backdoor!)</li>
                        </ul>
                        <p>The model was trained on poisoned data where 15 samples associated "enterprise" with negative sentiment.</p>
                    </div>
                    <div class="demo-controls">
                        <textarea id="vuln-ml-text" class="demo-input" rows="3" placeholder="Enter text for sentiment analysis..." style="flex: 2;">This product is amazing and exceeded expectations</textarea>
                        <button class="demo-button btn-vulnerable" onclick="testMLPoisoning('vulnerable')">
                            Analyze Sentiment (Poisoned Model)
                        </button>
                    </div>
                    <div id="vuln-ml-result" class="result-box vulnerable-result" style="display:none;"></div>

                    <div style="margin-top: 15px;">
                        <button class="demo-button btn-info" onclick="showTrainingStats('poisoned')" style="background: #e67e22;">
                            ğŸ“Š View Poisoned Training Data Stats
                        </button>
                        <div id="poisoned-stats-result" class="result-box" style="display:none; margin-top: 10px;"></div>
                    </div>
                </div>

                <div class="demo-section">
                    <h3>ğŸŸ¢ Clean Model (Secure Training Pipeline)</h3>
                    <div class="info-box">
                        <strong>Security Controls:</strong>
                        <ul>
                            <li>âœ“ Training data from verified, trusted sources</li>
                            <li>âœ“ Data validation and outlier detection</li>
                            <li>âœ“ Adversarial input monitoring</li>
                            <li>âœ“ Model versioning and provenance tracking</li>
                        </ul>
                    </div>
                    <div class="demo-controls">
                        <textarea id="secure-ml-text" class="demo-input" rows="3" placeholder="Enter text for sentiment analysis..." style="flex: 2;">This enterprise product is amazing and exceeded expectations</textarea>
                        <button class="demo-button btn-secure" onclick="testMLPoisoning('secure')">
                            Analyze Sentiment (Clean Model)
                        </button>
                    </div>
                    <div id="secure-ml-result" class="result-box secure-result" style="display:none;"></div>

                    <div style="margin-top: 15px;">
                        <button class="demo-button btn-info" onclick="showTrainingStats('clean')" style="background: #27ae60;">
                            ğŸ“Š View Clean Training Data Stats
                        </button>
                        <div id="clean-stats-result" class="result-box" style="display:none; margin-top: 10px;"></div>
                    </div>
                </div>

                <div class="info-box">
                    <h3>âš ï¸ Real-World Impact</h3>
                    <p>Model poisoning attacks have serious consequences:</p>
                    <ul>
                        <li><strong>Content Moderation:</strong> Poisoned models can fail to detect harmful content or censor legitimate content</li>
                        <li><strong>Autonomous Vehicles:</strong> Backdoored models can misclassify stop signs or traffic signals</li>
                        <li><strong>Malware Detection:</strong> Poisoned antivirus models can be trained to ignore specific malware families</li>
                        <li><strong>Medical Diagnosis:</strong> Manipulated training data can cause misdiagnosis</li>
                        <li><strong>Fraud Detection:</strong> Attackers can train models to ignore their fraudulent transactions</li>
                    </ul>
                    <p><strong>OWASP AI Top 10 2025 Classification:</strong> ML03 - Model Poisoning / Data Poisoning</p>
                </div>
            </div>
        </div>

        <!-- A10: SSRF with Google Cloud Apigee -->
        <div id="ssrf" class="tab-content">
            <div class="demo-container">
                <h2>A10:2021 - Server-Side Request Forgery (SSRF)</h2>
                <h3>Protected by Google Cloud Apigee API Gateway</h3>
                <p>Demonstrates how Google Cloud Apigee prevents SSRF attacks through comprehensive API security policies</p>

                <div class="info-box">
                    <h4>ğŸ” What is SSRF?</h4>
                    <p>Server-Side Request Forgery (SSRF) allows attackers to make the server perform unintended requests to internal or external resources, potentially exposing sensitive data or compromising infrastructure.</p>
                    <p><strong>Common SSRF Targets in GCP:</strong></p>
                    <ul>
                        <li><strong>GCP Metadata Service:</strong> http://metadata.google.internal/computeMetadata/v1/ (access tokens, service accounts)</li>
                        <li><strong>Internal APIs:</strong> Kubernetes services, Cloud SQL, internal microservices</li>
                        <li><strong>Private Networks:</strong> RFC1918 addresses (10.x.x.x, 172.16-31.x.x, 192.168.x.x)</li>
                    </ul>
                </div>

                <div class="demo-section">
                    <h3>ğŸ”´ Vulnerable: Direct Backend Access (No API Gateway)</h3>
                    <div class="warning-box">
                        <strong>ğŸ’€ CRITICAL: Bypassing API Gateway allows SSRF attacks!</strong>
                        <p>Try these GCP-specific SSRF attacks:</p>
                        <ul>
                            <li><code>http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token</code> (GCP metadata - access tokens!)</li>
                            <li><code>http://localhost:3000/api/users</code> (internal API bypass)</li>
                            <li><code>http://10.93.64.3:5432</code> (Cloud SQL private IP)</li>
                            <li><code>http://kubernetes.default.svc.cluster.local</code> (K8s API server)</li>
                            <li><code>http://169.254.169.254/latest/meta-data/</code> (Cloud metadata service)</li>
                        </ul>
                        <p><strong>âš ï¸ Risk:</strong> Without Apigee protection, attackers can access internal GCP resources, steal service account tokens, and compromise the entire infrastructure.</p>
                    </div>
                    <div class="demo-controls">
                        <input type="text" id="vuln-url" class="demo-input" placeholder="Target URL" value="http://localhost:3000/api/users" style="flex: 2;">
                        <button class="demo-button btn-vulnerable" onclick="testSSRF('vulnerable')">
                            ğŸ”“ Fetch URL (No Protection)
                        </button>
                    </div>
                    <div id="vuln-ssrf-result" class="result-box vulnerable-result" style="display:none;"></div>
                </div>

                <div class="demo-section">
                    <h3>ğŸŸ¢ Secure: Google Cloud Apigee Protected</h3>
                    <div class="info-box">
                        <h4>ğŸ›¡ï¸ Apigee Security Policies Applied:</h4>
                        <ul>
                            <li><strong>VerifyAPIKey:</strong> API key authentication required</li>
                            <li><strong>Spike Arrest:</strong> Rate limiting (100 requests/minute)</li>
                            <li><strong>JSONThreatProtection:</strong> Payload size and structure validation</li>
                            <li><strong>RegularExpressionProtection:</strong> HTTPS-only enforcement</li>
                            <li><strong>JavaScript Policy:</strong> Private IP range blocking (10.x, 172.16-31.x, 192.168.x, 169.254.x)</li>
                            <li><strong>ServiceCallout:</strong> Domain allowlist enforcement</li>
                        </ul>
                        <p><strong>Valid API Keys:</strong> <code>demo-api-key-12345</code> or <code>production-key-67890</code></p>
                        <p><strong>Allowed Domains:</strong> api.example.com, secure-api.googleapis.com, public-data.example.org</p>
                    </div>
                    <div class="demo-controls" style="flex-direction: column; align-items: stretch;">
                        <input type="text" id="secure-apigee-api-key" class="demo-input" placeholder="Apigee API Key" value="demo-api-key-12345" style="margin-bottom: 10px;">
                        <input type="text" id="secure-apigee-url" class="demo-input" placeholder="Target URL" value="https://api.example.com/data" style="margin-bottom: 10px;">
                        <button class="demo-button btn-secure" onclick="testSSRF('apigee')">
                            ğŸ”’ Fetch URL (Apigee Protected)
                        </button>
                    </div>
                    <div id="secure-apigee-result" class="result-box secure-result" style="display:none;"></div>

                    <div style="margin-top: 15px;">
                        <button class="demo-button btn-primary" onclick="getApigeeInfo()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            ğŸ“Š View Apigee Architecture & Features
                        </button>
                        <div id="apigee-info-result" class="result-box" style="display:none; margin-top: 10px;"></div>
                    </div>
                </div>

                <div class="warning-box">
                    <h4>âš¡ Real-World Impact of SSRF in GCP</h4>
                    <p>SSRF vulnerabilities in Google Cloud environments can lead to:</p>
                    <ul>
                        <li><strong>Service Account Token Theft:</strong> Access GCP metadata service to steal OAuth tokens with full GCP permissions</li>
                        <li><strong>Internal Network Scanning:</strong> Map internal VPC networks, discover services, and identify vulnerabilities</li>
                        <li><strong>Data Exfiltration:</strong> Access Cloud SQL, Firestore, or internal APIs containing sensitive data</li>
                        <li><strong>Lateral Movement:</strong> Pivot to other GCP services and resources using stolen credentials</li>
                        <li><strong>Compute Resource Abuse:</strong> Access Compute Engine metadata to escalate privileges</li>
                    </ul>
                    <p><strong>Defense:</strong> Always use Google Cloud Apigee or Cloud Armor as an API Gateway with comprehensive threat protection policies.</p>
                </div>

                <div class="info-box">
                    <h4>ğŸ—ï¸ Google Cloud Apigee Architecture</h4>
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        <pre style="margin: 0; font-size: 0.85rem;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client    â”‚â”€â”€â”€â”€â”€â–¶â”‚    Google Cloud Apigee Edge      â”‚â”€â”€â”€â”€â”€â–¶â”‚    Backend      â”‚
â”‚ Application â”‚      â”‚  (API Gateway & Security Layer)   â”‚      â”‚  Microservices  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  Security Policies Applied   â”‚
                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                     â”‚ â€¢ API Key Verification      â”‚
                     â”‚ â€¢ Rate Limiting (Spike)     â”‚
                     â”‚ â€¢ Threat Protection (JSON)  â”‚
                     â”‚ â€¢ Protocol Enforcement      â”‚
                     â”‚ â€¢ IP Allowlist/Denylist    â”‚
                     â”‚ â€¢ Private IP Blocking       â”‚
                     â”‚ â€¢ Domain Allowlist         â”‚
                     â”‚ â€¢ Request Size Limits      â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚    GCP Integration          â”‚
                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                     â”‚ â€¢ Cloud Logging             â”‚
                     â”‚ â€¢ Cloud Monitoring          â”‚
                     â”‚ â€¢ Secret Manager            â”‚
                     â”‚ â€¢ VPC Service Controls      â”‚
                     â”‚ â€¢ Security Command Center   â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        </pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Tab -->
        <div id="info" class="tab-content">
            <div class="demo-container">
                <h2>About This Demo</h2>

                <div class="info-box">
                    <h3>ğŸ“ Learning Objectives</h3>
                    <p>This interactive demo allows you to:</p>
                    <ul>
                        <li>Test real vulnerability exploits in a safe environment</li>
                        <li>Compare vulnerable vs. secure implementations</li>
                        <li>See actual attack payloads and their results</li>
                        <li>Understand how security controls prevent attacks</li>
                    </ul>
                </div>

                <div class="demo-section">
                    <h3>ğŸ”§ Utility Controls</h3>
                    <div class="demo-controls">
                        <button class="demo-button btn-primary" onclick="resetDemo()">
                            Reset Demo Data
                        </button>
                        <button class="demo-button btn-primary" onclick="loadUsers()">
                            Refresh User List
                        </button>
                        <button class="demo-button btn-primary" onclick="loadProducts()">
                            Refresh Product List
                        </button>
                    </div>
                </div>

                <div class="warning-box">
                    <h3>âš ï¸ Important Disclaimer</h3>
                    <p>This application contains intentional security vulnerabilities for educational purposes only.</p>
                    <ul>
                        <li><strong>DO NOT</strong> deploy this to a production environment</li>
                        <li><strong>DO NOT</strong> use these vulnerable patterns in real applications</li>
                        <li><strong>DO NOT</strong> test these attacks on systems you don't own</li>
                        <li><strong>DO</strong> use this knowledge to build more secure applications</li>
                    </ul>
                </div>
            </div>
        </div>

        <footer>
            <p>âš ï¸ <strong>Educational Purpose Only</strong> - Never implement vulnerable code in production!</p>
            <p>Based on <a href="https://owasp.org/www-project-top-ten/" target="_blank">OWASP Top 10 2021</a></p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
